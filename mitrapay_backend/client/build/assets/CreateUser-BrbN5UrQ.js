import{e as z,b as T,r as x,j as s,L as P,q as _,y as b}from"./index-BWCtnueZ.js";import{G as N,g as D}from"./index-CBUeCjhJ.js";function L(h){return N({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0zm0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M16.59 7.58 10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"},child:[]}]})(h)}function B(h){return N({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M12 5.9a2.1 2.1 0 1 1 0 4.2 2.1 2.1 0 0 1 0-4.2m0 9c2.97 0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 9c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"},child:[]}]})(h)}function K(h){return N({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"},child:[]}]})(h)}function $(){const h=z(),{user:a}=T(e=>e.user),n="rgb(255, 102, 0)",w="rgba(255, 102, 0, 0.3)",k="#121212",t="#1f1f1f",f="#2c2c2c",d="#e0e0e0",u="#a0a0a0",c="#3a3a3a",A=["Dashboard","Send Money","View Transaction","Money Transfer","Multiple Payments"].filter((e,r,l)=>l.indexOf(e)===r),[o,p]=x.useState({Name:"",User_name:"",email:"",Phone:"",status:"Active",Password:"",role:"User",Pages:[],Subadmin:(a==null?void 0:a.role)==="Super_Admin"?"":a==null?void 0:a._id,Key:"",CreatedBy:""}),[i,U]=x.useState({}),[y,C]=x.useState([]),[v,R]=x.useState({Name:"",role:"",email:""});x.useEffect(()=>{(a==null?void 0:a.role)==="Super_Admin"?(async()=>{try{const r=await _.get("/api/auth/View_subadmin",{withCredentials:!0});C(r.data.subadmins||[])}catch(r){r.response&&r.response.status===401?(b.error("Unauthorized access. Please log in again."),window.location.reload()):b.error("Failed to fetch subadmins")}})():a!=null&&a._id&&(C([{_id:a._id,Name:a.Name,role:a.role,email:a.email}]),p(e=>({...e,Subadmin:a._id,CreatedBy:{email:a.email,Name:a.Name,role:a.role}})))},[a==null?void 0:a._id,a==null?void 0:a.role]);const S=e=>{const{name:r,value:l}=e.target;p(m=>({...m,[r]:l}))},j=e=>{const r=o.Pages.includes(e)?o.Pages.filter(l=>l!==e):[...o.Pages,e];p({...o,Pages:r})},M=()=>{const e={};return console.log("selected subadmin:",v),(a==null?void 0:a.role)==="Super_Admin"&&v.Name===""&&o.Subadmin===""&&(e.SelctedSubadmins="Subadmin must be selected"),o.Name.trim()||(e.Name="Name is required"),o.User_name.trim()||(e.User_name="Username is required"),o.email.trim()?/\S+@\S+\.\S+/.test(o.email)||(e.email="Invalid email format"):e.email="Email is required",o.Phone.trim()?/^\d{10}$/.test(o.Phone)||(e.Phone="Phone must be 10 digits"):e.Phone="Phone number is required",o.Password?o.Password.length<8&&(e.Password="Password must be at least 8 characters"):e.Password="Password is required",o.Key.trim()||(e.Key="Key is required"),U(e),o.email&&(o.email=o.email.trim().toLowerCase()),Object.keys(e).length===0},E=async e=>{var l,m;if(e.preventDefault(),!M()){b.error("Please correct the form errors");return}const r={...o,Subadmin:(a==null?void 0:a.role)=="Super_Admin"?o.Subadmin:a._id};try{await _.post("/api/auth/Create_User",r,{withCredentials:!0}),console.log("User Creation Payload:",r),b.success("User created successfully!"),h("/viewUser")}catch(g){g.response&&g.response.status===401?(b.error("Unauthorized access. Please log in again."),window.location.reload()):b.error(((m=(l=g.response)==null?void 0:l.data)==null?void 0:m.message)||"Something went wrong")}},O=e=>{const{value:r}=e.target,l=y.find(m=>m._id===r);R(l?{Name:l.Name,role:l.role,email:l.email}:{Name:"",role:"",email:""}),p(m=>({...m,Subadmin:r,CreatedBy:l?{email:l.email,Name:l.Name,role:l.role}:""}))};return s.jsx("div",{className:"container py-5",style:{backgroundColor:k,minHeight:"100vh"},children:s.jsx("div",{className:"row justify-content-center",children:s.jsxs("div",{className:"col-lg-9",children:[s.jsxs("header",{className:"d-flex align-items-center justify-content-between mb-4",children:[s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx(P,{to:"/viewUser",className:"btn rounded-circle me-3",style:{width:"40px",height:"40px",border:`1px solid ${c}`,backgroundColor:t},children:s.jsx(D,{className:"fs-6",style:{color:d}})}),s.jsx("h1",{className:"h4 fw-bold mb-0",style:{color:d},children:"New User Onboarding"})]}),s.jsx(P,{to:"/viewUser",className:"btn px-4 py-2 fw-semibold rounded",style:{backgroundColor:t,color:n,border:`1px solid ${n}`,borderRadius:"8px"},children:"View Users"})]}),s.jsx("form",{className:"p-4 p-md-5 rounded shadow-lg",onSubmit:E,style:{backgroundColor:t,borderRadius:"12px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.4)"},children:s.jsxs("div",{className:"row g-4",children:[s.jsxs("div",{className:"col-12 mb-3",children:[s.jsxs("h5",{className:"fw-bold mb-3 d-flex align-items-center",style:{color:d},children:[s.jsx(B,{className:"me-2 fs-4",style:{color:n}}),"User & Contact Details"]}),s.jsxs("div",{className:"row g-4 border rounded p-4",style:{borderColor:c,backgroundColor:f},children:[s.jsxs("div",{className:"col-md-6",children:[s.jsx("label",{className:"form-label fw-medium small mb-1",style:{color:u},children:"Assigned Co Admin"}),s.jsxs("select",{name:"Subadmin",className:`form-select ${i.SelctedSubadmins?"is-invalid":""}`,onChange:O,disabled:(a==null?void 0:a.role)!=="Super_Admin",style:{borderRadius:"6px",padding:"10px 12px",borderColor:i.SelctedSubadmins?"#dc3545":c,backgroundColor:t,color:d,transition:"border-color 0.2s, box-shadow 0.2s",WebkitAppearance:"none",appearance:"none"},children:[s.jsx("option",{value:"",style:{backgroundColor:t},children:(a==null?void 0:a.role)==="Super_Admin"?"Select Co Admin":a==null?void 0:a.Name}),y.map(e=>s.jsxs("option",{value:e._id,name:e.Name,style:{backgroundColor:t},children:[e.Name," (",e.email,")"]},e._id))]}),i.SelctedSubadmins&&s.jsx("div",{className:"invalid-feedback",children:i.SelctedSubadmins})]}),[{id:"Name",label:"Full Name"},{id:"User_name",label:"Username"},{id:"email",label:"Email Address",type:"email"},{id:"Phone",label:"Phone Number"}].map(({id:e,label:r,type:l="text"})=>s.jsxs("div",{className:"col-md-6",children:[s.jsx("label",{htmlFor:e,className:"form-label fw-medium small mb-1",style:{color:u},children:r}),s.jsx("input",{id:e,name:e,type:l,value:o[e],onChange:S,className:`form-control ${i[e]?"is-invalid":""}`,style:{borderRadius:"6px",padding:"10px 12px",borderColor:i[e]?"#dc3545":c,backgroundColor:t,color:d,transition:"border-color 0.2s, box-shadow 0.2s"}}),i[e]&&s.jsx("div",{className:"invalid-feedback",children:i[e]})]},e))]})]}),s.jsxs("div",{className:"col-12 mb-3",children:[s.jsxs("h5",{className:"fw-bold mb-3 d-flex align-items-center",style:{color:d},children:[s.jsx(K,{className:"me-2 fs-4",style:{color:n}}),"Security & Credentials"]}),s.jsx("div",{className:"row g-4 border rounded p-4",style:{borderColor:c,backgroundColor:f},children:[{id:"Password",label:"Password",type:"password"},{id:"Key",label:"API Key / Secret Key",type:"password"}].map(({id:e,label:r,type:l})=>s.jsxs("div",{className:"col-md-6",children:[s.jsx("label",{htmlFor:e,className:"form-label fw-medium small mb-1",style:{color:u},children:r}),s.jsx("input",{id:e,name:e,type:l,value:o[e],onChange:S,className:`form-control ${i[e]?"is-invalid":""}`,style:{borderRadius:"6px",padding:"10px 12px",borderColor:i[e]?"#dc3545":c,backgroundColor:t,color:d,transition:"border-color 0.2s, box-shadow 0.2s"}}),i[e]&&s.jsx("div",{className:"invalid-feedback",children:i[e]})]},e))})]}),s.jsxs("div",{className:"col-12 pt-3",children:[s.jsxs("h5",{className:"fw-bold mb-3 d-flex align-items-center",style:{color:d},children:[s.jsx(L,{className:"me-2 fs-4",style:{color:n}}),"Page Access Permissions"]}),s.jsx("div",{className:"row g-3 border rounded p-4",style:{borderColor:c,backgroundColor:f},children:A.map(e=>{const r=o.Pages.includes(e);return s.jsx("div",{className:"col-lg-4 col-md-6 col-sm-6",children:s.jsxs("div",{className:"d-flex justify-content-between align-items-center px-3 py-2 rounded-lg user-select-none",style:{border:`1px solid ${r?n:c}`,backgroundColor:r?w:t,transition:"all 0.2s ease",cursor:"pointer",borderRadius:"8px",boxShadow:r?`0 1px 5px ${w}`:"none"},onClick:()=>j(e),children:[s.jsx("span",{className:"fw-medium small",style:{color:r?n:d},children:e}),s.jsx("div",{className:"form-check form-switch m-0",children:s.jsx("input",{className:"form-check-input",type:"checkbox",checked:r,onChange:()=>j(e),style:{backgroundColor:r?n:u,borderColor:r?n:u,boxShadow:"none"}})})]})},e)})})]}),s.jsx("div",{className:"col-12 text-center mt-5",children:s.jsx("button",{type:"submit",className:"btn btn-lg px-5 py-3 fw-bold rounded-pill shadow",style:{backgroundColor:n,color:"white",boxShadow:`0 8px 20px ${n}99`,transition:"all 0.3s ease"},children:"Confirm and Create User"})})]})})]})})})}export{$ as default};
